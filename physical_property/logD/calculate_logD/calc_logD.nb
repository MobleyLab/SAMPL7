(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    120453,       3046]
NotebookOptionsPosition[    116513,       2993]
NotebookOutlinePosition[    117033,       3012]
CellTagsIndexPosition[    116990,       3009]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"exp", "=", 
    RowBox[{
     RowBox[{
     "Import", "[", 
      "\"\<../../experimental_data/Experimental_Properties_of_SAMPL7_\
Compounds.csv\>\"", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"2", ";;"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "7", ",", "8"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Set", " ", "active", " ", "directory", " ", "and", " ", "import", " ", 
    "experimental", " ", "logD", " ", "data"}], 
   "*)"}]}], "\[IndentingNewLine]", "exp"}], "Input",
 CellChangeTimes->{{3.8115299356460733`*^9, 3.811529955884295*^9}, {
  3.822720374371791*^9, 3.822720408954632*^9}, {3.823066797094819*^9, 
  3.8230667997537003`*^9}, {3.8230669395343513`*^9, 3.823066946458387*^9}, {
  3.8235820182085996`*^9, 3.8235820192650223`*^9}, {3.8250565297613287`*^9, 
  3.82505655441084*^9}, {3.826916292123234*^9, 3.826916300273614*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"e07bf09a-837b-4f9f-8ae3-5348be5ddf17"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.82691631945011*^9},
 NumberMarks->False,ExpressionUUID->"aabee575-ae6b-41e4-b5f0-da1db60272a3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.826916317330329*^9, 
  3.82691631780154*^9}},ExpressionUUID->"78eb6dc2-16ad-4001-9098-\
f6012ebe6827"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pka", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", 
     "\"\<../../pKa/analysis/macrostate_analysis/analysis_outputs_ranked_\
submissions/pKa_submission_collection.csv\>\"", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "11"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logP", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", 
     "\"\<../../logP/analysis/analysis_outputs_ranked_submissions/logP_\
submission_collection.csv\>\"", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "11"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pka", "=", 
   RowBox[{"GatherBy", "[", 
    RowBox[{"pka", ",", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logP", "=", 
   RowBox[{"GatherBy", "[", 
    RowBox[{"logP", ",", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pka", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"logP", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "=", "\"\<#\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pkamods", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Flatten", "@", 
     RowBox[{"pka", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logPmods", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Flatten", "@", 
     RowBox[{"logP", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Load", " ", "all", " ", "ranked", " ", "pKa", " ", "and", " ", "logP", 
     " ", "submissions"}], ",", " ", 
    RowBox[{
    "group", " ", "them", " ", "by", " ", "their", " ", 
     "\"\<method_name\>\""}], ",", " ", 
    RowBox[{
    "and", " ", "gather", " ", "the", " ", "pka", " ", "and", " ", "logP", 
     " ", "\"\<method_name\>\"", " ", "entries", " ", "in", " ", "seperate", 
     " ", 
     RowBox[{"lists", "."}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.82272085317456*^9, 3.822720919245789*^9}, {
   3.822720955332499*^9, 3.8227209576312923`*^9}, {3.822720988382762*^9, 
   3.822721015997744*^9}, {3.822721208958939*^9, 3.8227212298784103`*^9}, {
   3.8227223227436028`*^9, 3.8227223267168093`*^9}, {3.822724152548483*^9, 
   3.8227241841946917`*^9}, {3.822724266587825*^9, 3.822724310699335*^9}, 
   3.822724362680287*^9, {3.822724912223765*^9, 3.8227249420309143`*^9}, {
   3.822729699667747*^9, 3.822729744023656*^9}, {3.8227297860990257`*^9, 
   3.82272979301912*^9}, 3.822733768165785*^9, {3.823072313499487*^9, 
   3.823072318110059*^9}, {3.823072655259222*^9, 3.82307265610286*^9}, {
   3.823072690324131*^9, 3.823072691099353*^9}, {3.823074787092334*^9, 
   3.823074787720675*^9}, 3.8230791607452707`*^9, {3.8236631253101797`*^9, 
   3.823663148058075*^9}, {3.8236937160189795`*^9, 3.8236938249806705`*^9}, {
   3.8250570116931624`*^9, 3.8250570303660994`*^9}, {3.8250570615801506`*^9, 
   3.8250571382860146`*^9}, {3.8250577383213468`*^9, 3.825057740022767*^9}, {
   3.826916324033813*^9, 3.826916330881905*^9}, {3.8269169221293173`*^9, 
   3.826916968353787*^9}, {3.826920451822174*^9, 3.826920453142448*^9}, {
   3.826920630361574*^9, 3.826920633481082*^9}, {3.826920822624713*^9, 
   3.826920853585017*^9}, {3.826920899640647*^9, 3.826920907016102*^9}, {
   3.826920950054283*^9, 3.8269209575036993`*^9}, {3.826920987786429*^9, 
   3.826921020937668*^9}, {3.826921053563636*^9, 3.8269210759462643`*^9}, {
   3.8269211819890957`*^9, 3.826921190881535*^9}, {3.826921313837212*^9, 
   3.8269213145074587`*^9}, {3.8269213497653437`*^9, 3.826921350515676*^9}, {
   3.8269294038804893`*^9, 3.8269294166358128`*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"8416a644-c7b6-49ed-b9a7-00441e0da565"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.826916351675564*^9, 3.82691637213054*^9}, 
   3.826929432951046*^9},ExpressionUUID->"7e9772ff-a5eb-4fea-abe4-\
9be5751b52ec"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.826929431090887*^9, 
  3.826929431091745*^9}},ExpressionUUID->"980770e8-8c7c-4c9b-9c96-\
921e9bac7453"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"assoc", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "6"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logDmods", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"logPmods", "[", 
       RowBox[{"[", 
        RowBox[{"assoc", "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "<>", 
      "\"\</\>\"", "<>", 
      RowBox[{"pkamods", "[", 
       RowBox[{"[", 
        RowBox[{"assoc", "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"logDmods", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Manual", " ", "combination", " ", "of", " ", "logP", " ", "and", " ", 
     "pKa", " ", "submission", " ", "from", " ", "the", " ", "same", " ", 
     "\"\<Participant organization\>\""}], ",", " ", 
    RowBox[{
     RowBox[{"e", ".", "g", ".", " ", "logP"}], " ", "entry", " ", "2", " ", 
     "is", " ", "associated", " ", "with", " ", "pKa", " ", "entry", " ", 
     "4"}], ",", " ", 
    RowBox[{"8", " ", "with", " ", "5", " ", "and", " ", "so", " ", 
     RowBox[{"on", ".", " ", "List"}], " ", "the", " ", 
     RowBox[{"logP", "/", "pKa"}], " ", "model", " ", "combinations", " ", 
     "here", " ", "as", " ", "a", " ", "sanity", " ", 
     RowBox[{"check", "."}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8227229928172483`*^9, 3.822723062870565*^9}, {
   3.822729800685411*^9, 3.822729879042808*^9}, {3.822734120023357*^9, 
   3.8227341202943363`*^9}, {3.822738150202759*^9, 3.822738176533668*^9}, {
   3.823071934288542*^9, 3.823071934907839*^9}, {3.823072375374188*^9, 
   3.823072378813776*^9}, {3.823072541902214*^9, 3.823072565639057*^9}, {
   3.8230730274766817`*^9, 3.823073036130043*^9}, {3.823074382242488*^9, 
   3.82307438961628*^9}, {3.823074434976383*^9, 3.823074445626651*^9}, 
   3.823079158462379*^9, {3.823144654829192*^9, 3.823144656136723*^9}, {
   3.82368752851817*^9, 3.8236875342090707`*^9}, {3.8250572677204437`*^9, 
   3.8250573166948385`*^9}, {3.825057354982473*^9, 3.8250573764850693`*^9}, {
   3.825057420355569*^9, 3.825057485812785*^9}, {3.825061458999426*^9, 
   3.8250614795426702`*^9}, {3.826916395563149*^9, 3.826916400235808*^9}, {
   3.826918126179839*^9, 3.826918131457*^9}, 3.8269182552180223`*^9},
 CellLabel->
  "In[282]:=",ExpressionUUID->"8379e00e-31fd-45ee-947a-f7bdd9f9030f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"logP", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "1"}], "]"}], "]"}], ",", "jj", ",", 
               "All"}], "]"}], "]"}], ",", 
            RowBox[{"pka", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "1", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "8"}], 
                "}"}]}], "]"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"logP", "[", 
            RowBox[{"[", 
             RowBox[{"assoc", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}], 
         "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "9", ",", "3", ",", "10", ",", "4", ",", "11", ",",
         "5", ",", "6", ",", "7", ",", "12", ",", "8", ",", "13"}], "}"}]}], 
     "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"logD", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "All"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "==", "\"\<SM28\>\""}], "||", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "==", "\"\<SM33\>\""}]}], "&"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "logD"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"logD", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "All"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "!=", "\"\<SM28\>\""}], "&&", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "!=", "\"\<SM33\>\""}]}], "&"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "logD"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Initiate", " ", "the", " ", "logD", " ", "list", " ", "to", " ", "be", 
     " ", "exported", " ", "later", " ", "so", " ", "that", " ", "it", " ", 
     "already", " ", "contains", " ", "the", " ", "pka", " ", "and", " ", 
     "logP", " ", "data"}], ",", " ", "errors", ",", " ", 
    RowBox[{
     RowBox[{"method", " ", "names", " ", 
      RowBox[{"etc", ".", "\[IndentingNewLine]", "Skip"}], " ", "SM28", " ", 
      "and", " ", "SM33", " ", "because", " ", "for", " ", "these", " ", 
      "molecules", " ", "pKa"}], " ", ">", " ", 
     RowBox[{
     "12", " ", "and", " ", "no", " ", "predicted", " ", "pKa", " ", "is", 
      " ", 
      RowBox[{"given", ".", " ", "Use"}], " ", "the", " ", "list", " ", 
      "\"\<tmp\>\"", " ", "to", " ", "remerge", " ", "SM28", " ", "and", " ", 
      "SM33", " ", "entries", " ", "after", " ", "calculating", " ", "logD", 
      " ", "for", " ", "all", " ", "other", " ", 
      RowBox[{"compounds", "."}]}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.813313473421191*^9, 3.813313589514941*^9}, 
   3.813313671483691*^9, {3.813313853358691*^9, 3.813313869561816*^9}, {
   3.813313905468066*^9, 3.813313908952441*^9}, {3.813313940671191*^9, 
   3.813313943264941*^9}, {3.822721346762309*^9, 3.822721347792636*^9}, {
   3.822721766034278*^9, 3.822721936410342*^9}, {3.82272204662801*^9, 
   3.822722089131222*^9}, {3.8227221384138412`*^9, 3.822722175380028*^9}, {
   3.8227231080243397`*^9, 3.822723267841703*^9}, {3.822723544460298*^9, 
   3.8227235565425377`*^9}, {3.8227235938108397`*^9, 3.8227236757791*^9}, {
   3.822724012182016*^9, 3.822724017467703*^9}, {3.822725423161537*^9, 
   3.82272545924118*^9}, {3.822725508763267*^9, 3.8227255165931873`*^9}, {
   3.822725556074925*^9, 3.822725595568293*^9}, {3.8227259171263857`*^9, 
   3.822725929141288*^9}, {3.822726603845252*^9, 3.822726639092874*^9}, {
   3.8227266695655107`*^9, 3.8227266833945723`*^9}, {3.822726725335083*^9, 
   3.8227267318018312`*^9}, {3.822729944451618*^9, 3.8227301142522507`*^9}, {
   3.822730192548806*^9, 3.822730291181621*^9}, {3.8227335102063026`*^9, 
   3.822733515000246*^9}, {3.822735544535851*^9, 3.822735581979568*^9}, {
   3.822735641213106*^9, 3.822735646052837*^9}, {3.822736709859652*^9, 
   3.822736782259831*^9}, {3.8230786544705687`*^9, 3.823078676471931*^9}, {
   3.82307874767752*^9, 3.823078749413064*^9}, {3.823678121353013*^9, 
   3.823678125399952*^9}, {3.8236782247689877`*^9, 3.8236783322398105`*^9}, {
   3.8236796365113897`*^9, 3.823679651769524*^9}, {3.823679779120246*^9, 
   3.8236797964284253`*^9}, {3.8236798991641235`*^9, 3.823679975381322*^9}, {
   3.823680011512501*^9, 3.8236800403628726`*^9}, 3.823680083640499*^9, {
   3.8236802054423437`*^9, 3.8236802148253746`*^9}, 3.8236803474147067`*^9, {
   3.8236803929106684`*^9, 3.8236803930337095`*^9}, 3.8236807122253532`*^9, {
   3.8236809045583506`*^9, 3.823680947906972*^9}, {3.823681278161251*^9, 
   3.8236813472678576`*^9}, 3.823683782587288*^9, {3.8236838676414857`*^9, 
   3.823683908554928*^9}, {3.8236839387300186`*^9, 3.8236840904295044`*^9}, {
   3.823684349393591*^9, 3.8236844171909504`*^9}, {3.8236852431813107`*^9, 
   3.8236852633212123`*^9}, {3.823687499923328*^9, 3.823687511297411*^9}, {
   3.8236941703738494`*^9, 3.823694194440398*^9}, {3.8236943172685785`*^9, 
   3.823694431892218*^9}, {3.823696254253566*^9, 3.8236962543160844`*^9}, 
   3.8238600363712325`*^9, 3.8238691492203074`*^9, {3.8238692459658766`*^9, 
   3.8238692932472935`*^9}, {3.8238710891500287`*^9, 
   3.8238711149814725`*^9}, {3.8238712254815006`*^9, 
   3.8238712286898937`*^9}, {3.8239370851849346`*^9, 3.823937101705805*^9}, {
   3.8239376673934155`*^9, 3.823937669917285*^9}, {3.8239401003548517`*^9, 
   3.8239401123256245`*^9}, {3.8239415383293805`*^9, 
   3.8239415413394456`*^9}, {3.825057597050869*^9, 3.8250576724434853`*^9}, {
   3.8250577829726515`*^9, 3.825057784093907*^9}, {3.8250578468296676`*^9, 
   3.8250578568350163`*^9}, 3.8250579676140537`*^9, {3.825058059146756*^9, 
   3.8250580849243584`*^9}, {3.8250586839387293`*^9, 3.825058691180912*^9}, {
   3.8269164096988907`*^9, 3.826916446521607*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"9f3db9fc-4bd0-4901-a278-800e3ef14180"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"True", ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Only", " ", "this", " ", "branch", " ", "is", " ", 
           RowBox[{"evaluated", ".", " ", "Calculates"}], " ", "the", " ", 
           "log", " ", "D7", ".4", " ", "according", " ", "to", " ", 
           RowBox[{"e", ".", "g", ".", " ", "Scherrer"}], " ", "RA"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Howard", " ", "SM", " ", 
            RowBox[{"(", "1977", ")"}], " ", "J", " ", "Med", " ", "Chem", 
            " ", "20"}], ":", 
           RowBox[{"53", "-", "58"}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "and", " ", "the", " ", "combined", " ", "SEM", " ", "and", " ", 
            "model", " ", 
            RowBox[{"uncertainties", ".", "\[IndentingNewLine]", "logD"}]}], 
           "=", 
           RowBox[{"logP", "+", 
            RowBox[{"Log10", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", "pKa"}], ")"}]}]}], ")"}]}]}]}]}]}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"logD", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "+", 
             RowBox[{"Log10", "[", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", 
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}], "]"}]}], ",", 
            "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"7.4", "-", 
                   RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", 
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}], "^", 
             "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "11"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"7.4", "-", 
                   RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", 
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}], "^", 
             "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "13"}], "]"}], "]"}]}]}]}], ";"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "This", " ", "branch", " ", "is", " ", "never", " ", "evaluated"}], 
          ",", " ", 
          RowBox[{
          "but", " ", "would", " ", "do", " ", "the", " ", "same", " ", "as", 
           " ", "the", " ", "other", " ", "branch", " ", "only", " ", "for", 
           " ", 
           RowBox[{"\"\<bases\>\"", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"logD", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "+", 
             RowBox[{"Log10", "[", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}]}], ")"}]}], 
              "]"}]}], ",", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}], ")"}]}], "/", 
               
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}]}], ")"}]}], 
              ")"}], "^", "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "11"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}], ")"}]}], "/", 
               
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}]}], ")"}]}], 
              ")"}], "^", "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "13"}], "]"}], "]"}]}]}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", 
        RowBox[{"Length", "@", 
         RowBox[{"logD", "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", 
      RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"logD", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], ",", 
        RowBox[{"tmp", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "logD"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "tmp", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Technically", " ", "a", " ", "list", " ", "of", " ", "the", " ", 
     "ionization", " ", "states", " ", "for", " ", "the", " ", "most", " ", 
     "relevant", " ", "pKa", " ", "transitions", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"i", ".", "e", ".", " ", "0"}], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], " ", "or", " ", "1"}], "\[Rule]", 
        RowBox[{"0", " ", 
         RowBox[{"etc", "."}]}]}]}], ")"}], " ", "for", " ", "each", " ", 
     "compound", " ", "and", " ", "each", " ", "submission", " ", "is", " ", 
     "needed", " ", "to", " ", "differentiate", " ", "\"\<acids\>\"", " ", 
     "and", " ", "\"\<bases\>\""}], ",", " ", 
    RowBox[{
    "especially", " ", "if", " ", "there", " ", "is", " ", "disagreement", 
     " ", "between", " ", "different", " ", 
     RowBox[{"methods", ".", " ", "Submissions"}], " ", "that", " ", 
     "included", " ", "macrostate", " ", "pKa", " ", "values", " ", "agreed", 
     " ", "that", " ", "every", " ", "relevant", " ", "transition", " ", "is",
      " ", "\"\<0\[Rule]-1\>\"", " ", "so", " ", "only", " ", "this", " ", 
     "equation", " ", "is", " ", "used", " ", "here", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"If", "[", 
        RowBox[{"True", ",", "..."}], "]"}], ")"}], ".", 
      "\[IndentingNewLine]", "After"}], " ", "calculation", " ", "of", " ", 
     "the", " ", "logD", " ", "values", " ", "the", " ", "\"\<tmp\>\"", " ", 
     "list", " ", "containing", " ", "the", " ", "logP", " ", "data", " ", 
     "for", " ", "SM28", " ", "and", " ", "SM33", " ", "is", " ", "merged", 
     " ", "with", " ", "the", " ", "logD", " ", "list", " ", 
     RowBox[{"again", "."}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.813313473421191*^9, 3.813313589514941*^9}, 
   3.813313671483691*^9, {3.813313853358691*^9, 3.813313869561816*^9}, {
   3.813313905468066*^9, 3.813313908952441*^9}, {3.813313940671191*^9, 
   3.813313943264941*^9}, {3.822721346762309*^9, 3.822721347792636*^9}, {
   3.822721766034278*^9, 3.822721936410342*^9}, {3.82272204662801*^9, 
   3.822722089131222*^9}, {3.8227221384138412`*^9, 3.822722175380028*^9}, {
   3.8227231080243397`*^9, 3.822723267841703*^9}, {3.822723544460298*^9, 
   3.8227235565425377`*^9}, {3.8227235938108397`*^9, 3.8227236757791*^9}, {
   3.822724012182016*^9, 3.822724017467703*^9}, {3.822725423161537*^9, 
   3.82272545924118*^9}, {3.822725508763267*^9, 3.8227255165931873`*^9}, {
   3.822725556074925*^9, 3.822725595568293*^9}, {3.8227259171263857`*^9, 
   3.822725929141288*^9}, {3.822726603845252*^9, 3.822726639092874*^9}, {
   3.8227266695655107`*^9, 3.8227266833945723`*^9}, {3.822726725335083*^9, 
   3.8227267318018312`*^9}, {3.822729944451618*^9, 3.8227301142522507`*^9}, {
   3.822730192548806*^9, 3.822730291181621*^9}, {3.8227335102063026`*^9, 
   3.822733515000246*^9}, {3.822735544535851*^9, 3.822735581979568*^9}, {
   3.822735641213106*^9, 3.822735646052837*^9}, {3.822736709859652*^9, 
   3.822736782259831*^9}, {3.8230786544705687`*^9, 3.823078676471931*^9}, {
   3.82307874767752*^9, 3.823078749413064*^9}, {3.823678121353013*^9, 
   3.823678125399952*^9}, {3.8236782247689877`*^9, 3.8236783322398105`*^9}, {
   3.8236796365113897`*^9, 3.823679651769524*^9}, {3.823679779120246*^9, 
   3.8236797964284253`*^9}, {3.8236798991641235`*^9, 3.823679975381322*^9}, {
   3.823680011512501*^9, 3.8236800403628726`*^9}, 3.823680083640499*^9, {
   3.8236802054423437`*^9, 3.8236802148253746`*^9}, 3.8236803474147067`*^9, {
   3.8236803929106684`*^9, 3.8236803930337095`*^9}, 3.8236807122253532`*^9, {
   3.8236809045583506`*^9, 3.823680947906972*^9}, {3.823681278161251*^9, 
   3.8236813472678576`*^9}, 3.823683782587288*^9, {3.8236838676414857`*^9, 
   3.823683908554928*^9}, {3.8236839387300186`*^9, 3.8236840904295044`*^9}, {
   3.823684349393591*^9, 3.8236844171909504`*^9}, {3.8236852431813107`*^9, 
   3.8236852633212123`*^9}, {3.823687499923328*^9, 3.823687511297411*^9}, {
   3.8236941703738494`*^9, 3.823694194440398*^9}, {3.8236943172685785`*^9, 
   3.823694431892218*^9}, {3.823696254253566*^9, 3.8236962543160844`*^9}, 
   3.8238600363712325`*^9, 3.8238691492203074`*^9, {3.8238692459658766`*^9, 
   3.8238692932472935`*^9}, {3.8238710891500287`*^9, 
   3.8238711149814725`*^9}, {3.8238712254815006`*^9, 
   3.8238712286898937`*^9}, {3.8239370851849346`*^9, 3.823937101705805*^9}, {
   3.8239376673934155`*^9, 3.823937669917285*^9}, {3.8239401003548517`*^9, 
   3.8239401123256245`*^9}, {3.8239415383293805`*^9, 
   3.8239415413394456`*^9}, {3.825057597050869*^9, 3.8250576724434853`*^9}, {
   3.8250577829726515`*^9, 3.825057784093907*^9}, {3.8250578468296676`*^9, 
   3.8250578568350163`*^9}, 3.8250579676140537`*^9, {3.825058133521*^9, 
   3.8250581727535563`*^9}, {3.825058214540615*^9, 3.8250582835920258`*^9}, {
   3.825058473490491*^9, 3.8250586033852425`*^9}, {3.8250586762239475`*^9, 
   3.8250587265442257`*^9}, {3.8250588359787335`*^9, 
   3.8250588568068843`*^9}, {3.8250589120544124`*^9, 3.825059012864532*^9}, {
   3.8250591321885853`*^9, 3.825059141005411*^9}, {3.825061624401218*^9, 
   3.8250617547800684`*^9}, {3.8250636546437287`*^9, 
   3.8250636672786117`*^9}, {3.825063698811824*^9, 3.8250637007755604`*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"8dcda01e-2c9e-4dc5-8077-5ebe246709ad"],

Cell[BoxData["0.8000000000692732`"], "Input",
 NumberMarks->False,
 CellLabel->
  "In[106]:=",ExpressionUUID->"8c5188f9-101e-4c8a-96a9-05815eea9909"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "logD", "]"}], ",", "13"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logD", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{"ii", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "0", ",", 
       RowBox[{
        RowBox[{"Length", "@", "logD"}], "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"logD", ",", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"exp", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}], "]"}], ",", 
       "3"}], "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logD", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "16"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"logD", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "9"}], "]"}], "]"}], "-", 
    RowBox[{"logD", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "14"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"logD", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "8", ",", "9", ",", "10", ",", "14", ",", "15", ",", "16", ",", 
        "12"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Prepare", " ", "logD", " ", "Table", " ", "for", " ", 
     RowBox[{"export", ".", " ", "Experimental"}], " ", "data", " ", "is", 
     " ", "added", " ", "to", " ", "the", " ", "list"}], ",", " ", 
    RowBox[{
    "the", " ", "difference", " ", "between", " ", "predicted", " ", "and", 
     " ", "experimental", " ", "values", " ", "calculated"}], ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "list", " ", "sorted", " ", "to", " ", "have", 
     " ", "the", " ", "same", " ", "shape", " ", "as", " ", "the", " ", 
     "other", " ", "\"\<submission_collection.csv\>\"", " ", "files"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.813313473421191*^9, 3.813313589514941*^9}, 
   3.813313671483691*^9, {3.813313853358691*^9, 3.813313869561816*^9}, {
   3.813313905468066*^9, 3.813313908952441*^9}, {3.813313940671191*^9, 
   3.813313943264941*^9}, {3.822721346762309*^9, 3.822721347792636*^9}, {
   3.822721766034278*^9, 3.822721936410342*^9}, {3.82272204662801*^9, 
   3.822722089131222*^9}, {3.8227221384138412`*^9, 3.822722175380028*^9}, {
   3.8227231080243397`*^9, 3.822723267841703*^9}, {3.822723544460298*^9, 
   3.8227235565425377`*^9}, {3.8227235938108397`*^9, 3.8227236757791*^9}, {
   3.822724012182016*^9, 3.822724017467703*^9}, {3.822725423161537*^9, 
   3.82272545924118*^9}, {3.822725508763267*^9, 3.8227255165931873`*^9}, {
   3.822725556074925*^9, 3.822725595568293*^9}, {3.8227259171263857`*^9, 
   3.822725929141288*^9}, {3.822726603845252*^9, 3.822726639092874*^9}, {
   3.8227266695655107`*^9, 3.8227266833945723`*^9}, {3.822726725335083*^9, 
   3.8227267318018312`*^9}, {3.822729944451618*^9, 3.8227301142522507`*^9}, {
   3.822730192548806*^9, 3.822730291181621*^9}, {3.8227335102063026`*^9, 
   3.822733515000246*^9}, {3.822735544535851*^9, 3.822735581979568*^9}, {
   3.822735641213106*^9, 3.822735646052837*^9}, {3.822736709859652*^9, 
   3.822736782259831*^9}, {3.8230786544705687`*^9, 3.823078676471931*^9}, {
   3.82307874767752*^9, 3.823078749413064*^9}, {3.823678121353013*^9, 
   3.823678125399952*^9}, {3.8236782247689877`*^9, 3.8236783322398105`*^9}, {
   3.8236796365113897`*^9, 3.823679651769524*^9}, {3.823679779120246*^9, 
   3.8236797964284253`*^9}, {3.8236798991641235`*^9, 3.823679975381322*^9}, {
   3.823680011512501*^9, 3.8236800403628726`*^9}, 3.823680083640499*^9, {
   3.8236802054423437`*^9, 3.8236802148253746`*^9}, 3.8236803474147067`*^9, {
   3.8236803929106684`*^9, 3.8236803930337095`*^9}, 3.8236807122253532`*^9, {
   3.8236809045583506`*^9, 3.823680947906972*^9}, {3.823681278161251*^9, 
   3.8236813472678576`*^9}, 3.823683782587288*^9, {3.8236838676414857`*^9, 
   3.823683908554928*^9}, {3.8236839387300186`*^9, 3.8236840904295044`*^9}, {
   3.823684349393591*^9, 3.8236844171909504`*^9}, {3.8236852431813107`*^9, 
   3.8236852633212123`*^9}, {3.823687499923328*^9, 3.823687511297411*^9}, {
   3.8236941703738494`*^9, 3.823694194440398*^9}, {3.8236943172685785`*^9, 
   3.823694431892218*^9}, {3.823696254253566*^9, 3.8236962543160844`*^9}, 
   3.8238600363712325`*^9, 3.8238691492203074`*^9, {3.8238692459658766`*^9, 
   3.8238692932472935`*^9}, {3.8238710891500287`*^9, 
   3.8238711149814725`*^9}, {3.8238712254815006`*^9, 
   3.8238712286898937`*^9}, {3.8239370851849346`*^9, 3.823937101705805*^9}, {
   3.8239376673934155`*^9, 3.823937669917285*^9}, {3.8239401003548517`*^9, 
   3.8239401123256245`*^9}, {3.8239415383293805`*^9, 
   3.8239415413394456`*^9}, {3.825057597050869*^9, 3.8250576724434853`*^9}, {
   3.8250577829726515`*^9, 3.825057784093907*^9}, {3.8250578468296676`*^9, 
   3.8250578568350163`*^9}, 3.8250579676140537`*^9, {3.825058133521*^9, 
   3.8250581727535563`*^9}, {3.825058214540615*^9, 3.8250582835920258`*^9}, {
   3.825058473490491*^9, 3.8250586033852425`*^9}, {3.8250586762239475`*^9, 
   3.8250587265442257`*^9}, {3.8250588359787335`*^9, 
   3.8250588568068843`*^9}, {3.8250589120544124`*^9, 3.825059012864532*^9}, {
   3.8250591321885853`*^9, 3.825059141005411*^9}, {3.8250599290648427`*^9, 
   3.8250600019288597`*^9}, {3.825060669366186*^9, 3.825060676597318*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"b8094c35-5837-436f-8f85-46a68c4f4313"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<./logD_submission_collection_ranked_only.csv\>\"", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{"logD", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\>\"", ",", "\"\<logP method_name\>\"", ",", 
        "\"\<pKa method_name\>\"", ",", "\"\<logP file name\>\"", ",", 
        "\"\<pKa file name\>\"", ",", "\"\<logP category\>\"", ",", 
        "\"\<pKa category\>\"", ",", "\"\<Molecule ID\>\"", ",", 
        "\"\<logD7.4 (calc)\>\"", ",", "\"\<logD SEM (calc)\>\"", ",", 
        "\"\<logD7.4 (exp)\>\"", ",", "\"\<logD7.4 SEM (exp)\>\"", ",", 
        "\"\<\[CapitalDelta]logD7.4 error (calc-exp)\>\"", ",", 
        "\"\<logD model uncertainty\>\""}], "}"}]}], "]"}], ",", 
    RowBox[{"\"\<TextDelimiters\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8236812984805346`*^9, 3.8236812990094843`*^9}, {
   3.8236820525048428`*^9, 3.8236820761082754`*^9}, {3.8236840994516354`*^9, 
   3.8236841106036716`*^9}, {3.823684141264588*^9, 3.823684157767174*^9}, {
   3.823684421940172*^9, 3.823684543744534*^9}, {3.8236846032033997`*^9, 
   3.8236846520660725`*^9}, {3.8236851924460034`*^9, 
   3.8236851990038924`*^9}, {3.823694450288293*^9, 3.823694451849846*^9}, {
   3.823694487436466*^9, 3.8236945549583187`*^9}, {3.823695019671069*^9, 
   3.8236950204267473`*^9}, {3.823937660332825*^9, 3.8239376630256453`*^9}, {
   3.8239380771485143`*^9, 3.8239380793477545`*^9}, 3.8239392401103687`*^9, {
   3.8239454404906864`*^9, 3.8239454533620615`*^9}, {3.825058923544533*^9, 
   3.825058923791282*^9}, {3.8250600067264957`*^9, 3.8250600068515368`*^9}, 
   3.826916577906931*^9, {3.826916669386735*^9, 3.826916677209249*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"a980ffde-5f1c-41eb-859a-645f6f681bab"],

Cell[BoxData[""], "Input",ExpressionUUID->"3bff58ae-3b3c-448e-abda-55839fc41921"],

Cell[TextData[StyleBox["Repeat, but this time calculate the logD using the \
experimental pKa and logP predictions",
 FontSize->36,
 Background->RGBColor[0.87, 0.94, 1]]], "Text",
 CellChangeTimes->{{3.82692946933809*^9, 
  3.826929510173562*^9}},ExpressionUUID->"df58675c-2edd-40a5-b990-\
47cdab947cbc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pka", "=", 
   RowBox[{
    RowBox[{"Import", "[", "\"\<./pKa_experimental.csv\>\"", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "8"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pka", "=", 
   RowBox[{"GatherBy", "[", 
    RowBox[{"pka", ",", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logP", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", 
     "\"\<../../logP/analysis/analysis_outputs_ranked_submissions/logP_\
submission_collection.csv\>\"", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "11"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logP", "=", 
   RowBox[{"GatherBy", "[", 
    RowBox[{"logP", ",", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pka", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"logP", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "=", "\"\<#\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pkamods", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Flatten", "@", 
     RowBox[{"pka", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logPmods", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Flatten", "@", 
     RowBox[{"logP", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Load", " ", "all", " ", "ranked", " ", "pKa", " ", "and", " ", "logP", 
     " ", "submissions"}], ",", " ", 
    RowBox[{
    "group", " ", "them", " ", "by", " ", "their", " ", 
     "\"\<method_name\>\""}], ",", " ", 
    RowBox[{
    "and", " ", "gather", " ", "the", " ", "pka", " ", "and", " ", "logP", 
     " ", "\"\<method_name\>\"", " ", "entries", " ", "in", " ", "seperate", 
     " ", 
     RowBox[{"lists", "."}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.826929586208441*^9, 3.8269295919606524`*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"b74e55a7-d1b9-41c4-9a63-38a9439472dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"assoc", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "2"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logDmods", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"logPmods", "[", 
       RowBox[{"[", 
        RowBox[{"assoc", "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "<>", 
      "\"\</\>\"", "<>", 
      RowBox[{"pkamods", "[", 
       RowBox[{"[", 
        RowBox[{"assoc", "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"logDmods", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Manual", " ", "combination", " ", "of", " ", "logP", " ", "and", " ", 
     "pKa", " ", "submission", " ", "from", " ", "the", " ", "same", " ", 
     "\"\<Participant organization\>\""}], ",", " ", 
    RowBox[{
     RowBox[{"e", ".", "g", ".", " ", "logP"}], " ", "entry", " ", "2", " ", 
     "is", " ", "associated", " ", "with", " ", "pKa", " ", "entry", " ", 
     "4"}], ",", " ", 
    RowBox[{"8", " ", "with", " ", "5", " ", "and", " ", "so", " ", 
     RowBox[{"on", ".", " ", "List"}], " ", "the", " ", 
     RowBox[{"logP", "/", "pKa"}], " ", "model", " ", "combinations", " ", 
     "here", " ", "as", " ", "a", " ", "sanity", " ", 
     RowBox[{"check", "."}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{3.826929618228241*^9},
 CellLabel->
  "In[304]:=",ExpressionUUID->"46025181-a9bc-49f3-8c42-8aac84ff2e6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"logP", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "1"}], "]"}], "]"}], ",", "jj", ",", 
               "All"}], "]"}], "]"}], ",", 
            RowBox[{"pka", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "1", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "8"}], 
                "}"}]}], "]"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"logP", "[", 
            RowBox[{"[", 
             RowBox[{"assoc", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}], 
         "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "9", ",", "3", ",", "10", ",", "4", ",", "11", ",",
         "5", ",", "6", ",", "7", ",", "12", ",", "8", ",", "13"}], "}"}]}], 
     "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"logD", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "All"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "==", "\"\<SM28\>\""}], "||", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "==", "\"\<SM33\>\""}]}], "&"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "logD"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"logD", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "All"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "!=", "\"\<SM28\>\""}], "&&", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "!=", "\"\<SM33\>\""}]}], "&"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "logD"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Initiate", " ", "the", " ", "logD", " ", "list", " ", "to", " ", "be", 
     " ", "exported", " ", "later", " ", "so", " ", "that", " ", "it", " ", 
     "already", " ", "contains", " ", "the", " ", "pka", " ", "and", " ", 
     "logP", " ", "data"}], ",", " ", "errors", ",", " ", 
    RowBox[{
     RowBox[{"method", " ", "names", " ", 
      RowBox[{"etc", ".", "\[IndentingNewLine]", "Skip"}], " ", "SM28", " ", 
      "and", " ", "SM33", " ", "because", " ", "for", " ", "these", " ", 
      "molecules", " ", "pKa"}], " ", ">", " ", 
     RowBox[{
     "12", " ", "and", " ", "no", " ", "predicted", " ", "pKa", " ", "is", 
      " ", 
      RowBox[{"given", ".", " ", "Use"}], " ", "the", " ", "list", " ", 
      "\"\<tmp\>\"", " ", "to", " ", "remerge", " ", "SM28", " ", "and", " ", 
      "SM33", " ", "entries", " ", "after", " ", "calculating", " ", "logD", 
      " ", "for", " ", "all", " ", "other", " ", 
      RowBox[{"compounds", "."}]}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{3.8269296598855467`*^9},
 CellLabel->
  "In[307]:=",ExpressionUUID->"a76dfec1-ca21-4cd9-a015-8f76f7008849"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"True", ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Only", " ", "this", " ", "branch", " ", "is", " ", 
           RowBox[{"evaluated", ".", " ", "Calculates"}], " ", "the", " ", 
           "log", " ", "D7", ".4", " ", "according", " ", "to", " ", 
           RowBox[{"e", ".", "g", ".", " ", "Scherrer"}], " ", "RA"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Howard", " ", "SM", " ", 
            RowBox[{"(", "1977", ")"}], " ", "J", " ", "Med", " ", "Chem", 
            " ", "20"}], ":", 
           RowBox[{"53", "-", "58"}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "and", " ", "the", " ", "combined", " ", "SEM", " ", "and", " ", 
            "model", " ", 
            RowBox[{"uncertainties", ".", "\[IndentingNewLine]", "logD"}]}], 
           "=", 
           RowBox[{"logP", "+", 
            RowBox[{"Log10", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", "pKa"}], ")"}]}]}], ")"}]}]}]}]}]}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"logD", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "+", 
             RowBox[{"Log10", "[", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", 
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}], "]"}]}], ",", 
            "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"7.4", "-", 
                   RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", 
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}], "^", 
             "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "11"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"7.4", "-", 
                   RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", 
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}], "^", 
             "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "13"}], "]"}], "]"}]}]}]}], ";"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "This", " ", "branch", " ", "is", " ", "never", " ", "evaluated"}], 
          ",", " ", 
          RowBox[{
          "but", " ", "would", " ", "do", " ", "the", " ", "same", " ", "as", 
           " ", "the", " ", "other", " ", "branch", " ", "only", " ", "for", 
           " ", 
           RowBox[{"\"\<bases\>\"", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"logD", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "+", 
             RowBox[{"Log10", "[", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}]}], ")"}]}], 
              "]"}]}], ",", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}], ")"}]}], "/", 
               
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}]}], ")"}]}], 
              ")"}], "^", "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "11"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}], ")"}]}], "/", 
               
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}]}], ")"}]}], 
              ")"}], "^", "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "13"}], "]"}], "]"}]}]}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", 
        RowBox[{"Length", "@", 
         RowBox[{"logD", "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", 
      RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"logD", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], ",", 
        RowBox[{"tmp", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "logD"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "tmp", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Technically", " ", "a", " ", "list", " ", "of", " ", "the", " ", 
     "ionization", " ", "states", " ", "for", " ", "the", " ", "most", " ", 
     "relevant", " ", "pKa", " ", "transitions", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"i", ".", "e", ".", " ", "0"}], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], " ", "or", " ", "1"}], "\[Rule]", 
        RowBox[{"0", " ", 
         RowBox[{"etc", "."}]}]}]}], ")"}], " ", "for", " ", "each", " ", 
     "compound", " ", "and", " ", "each", " ", "submission", " ", "is", " ", 
     "needed", " ", "to", " ", "differentiate", " ", "\"\<acids\>\"", " ", 
     "and", " ", "\"\<bases\>\""}], ",", " ", 
    RowBox[{
    "especially", " ", "if", " ", "there", " ", "is", " ", "disagreement", 
     " ", "between", " ", "different", " ", 
     RowBox[{"methods", ".", " ", "Submissions"}], " ", "that", " ", 
     "included", " ", "macrostate", " ", "pKa", " ", "values", " ", "agreed", 
     " ", "that", " ", "every", " ", "relevant", " ", "transition", " ", "is",
      " ", "\"\<0\[Rule]-1\>\"", " ", "so", " ", "only", " ", "this", " ", 
     "equation", " ", "is", " ", "used", " ", "here", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"If", "[", 
        RowBox[{"True", ",", "..."}], "]"}], ")"}], ".", 
      "\[IndentingNewLine]", "After"}], " ", "calculation", " ", "of", " ", 
     "the", " ", "logD", " ", "values", " ", "the", " ", "\"\<tmp\>\"", " ", 
     "list", " ", "containing", " ", "the", " ", "logP", " ", "data", " ", 
     "for", " ", "SM28", " ", "and", " ", "SM33", " ", "is", " ", "merged", 
     " ", "with", " ", "the", " ", "logD", " ", "list", " ", 
     RowBox[{"again", "."}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{3.8269296770043583`*^9},
 CellLabel->
  "In[310]:=",ExpressionUUID->"63b0d55f-6fbb-4f3b-a9af-9ce1536327eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "logD", "]"}], ",", "13"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logD", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{"ii", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "0", ",", 
       RowBox[{
        RowBox[{"Length", "@", "logD"}], "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"logD", ",", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"exp", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}], "]"}], ",", 
       "3"}], "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logD", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "16"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"logD", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "9"}], "]"}], "]"}], "-", 
    RowBox[{"logD", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "14"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"logD", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "8", ",", "9", ",", "10", ",", "14", ",", "15", ",", "16", ",", 
        "12"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Prepare", " ", "logD", " ", "Table", " ", "for", " ", 
     RowBox[{"export", ".", " ", "Experimental"}], " ", "data", " ", "is", 
     " ", "added", " ", "to", " ", "the", " ", "list"}], ",", " ", 
    RowBox[{
    "the", " ", "difference", " ", "between", " ", "predicted", " ", "and", 
     " ", "experimental", " ", "values", " ", "calculated"}], ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "list", " ", "sorted", " ", "to", " ", "have", 
     " ", "the", " ", "same", " ", "shape", " ", "as", " ", "the", " ", 
     "other", " ", "\"\<submission_collection.csv\>\"", " ", "files"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{3.826929694317877*^9},
 CellLabel->
  "In[313]:=",ExpressionUUID->"5d8e94f4-5668-40d1-9dc1-68714914e083"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<./logD_exp_pKa_and_all_ranked222.csv\>\"", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{"logD", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\>\"", ",", "\"\<logP method_name\>\"", ",", 
        "\"\<pKa method_name\>\"", ",", "\"\<logP file name\>\"", ",", 
        "\"\<pKa file name\>\"", ",", "\"\<logP category\>\"", ",", 
        "\"\<pKa category\>\"", ",", "\"\<Molecule ID\>\"", ",", 
        "\"\<logD7.4 (calc)\>\"", ",", "\"\<logD SEM (calc)\>\"", ",", 
        "\"\<logD7.4 (exp)\>\"", ",", "\"\<logD7.4 SEM (exp)\>\"", ",", 
        "\"\<\[CapitalDelta]logD7.4 error (calc-exp)\>\"", ",", 
        "\"\<logD model uncertainty\>\""}], "}"}]}], "]"}], ",", 
    RowBox[{"\"\<TextDelimiters\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.826929708040038*^9, 3.826929711902231*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"61e9f7d8-e1c9-4123-b3ee-977760a163c9"],

Cell[TextData[StyleBox["Repeat, but this time calculate the logD using the \
experimental logP and pKa predictions",
 FontSize->36,
 Background->RGBColor[0.87, 0.94, 1]]], "Text",
 CellChangeTimes->{{3.826929518730135*^9, 
  3.826929556051631*^9}},ExpressionUUID->"7c9679ce-82d8-4b8f-9256-\
ea3dfae70fd8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pka", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", 
     "\"\<../../pKa/analysis/macrostate_analysis/analysis_outputs_ranked_\
submissions/pKa_submission_collection.csv\>\"", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "11"}], "}"}]}], "]"}], "]"}]}], ";", 
  RowBox[{"logP", "=", 
   RowBox[{
    RowBox[{"Import", "[", "\"\<./logP_experimental.csv\>\"", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "8"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pka", "=", 
   RowBox[{"GatherBy", "[", 
    RowBox[{"pka", ",", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logP", "=", 
   RowBox[{"GatherBy", "[", 
    RowBox[{"logP", ",", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pka", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"logP", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "=", "\"\<#\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pkamods", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Flatten", "@", 
     RowBox[{"pka", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logPmods", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Flatten", "@", 
     RowBox[{"logP", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}]}], "]"}]}], ";"}], 
"\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Load", " ", "all", " ", "ranked", " ", "pKa", " ", "and", " ", "logP", 
     " ", "submissions"}], ",", " ", 
    RowBox[{
    "group", " ", "them", " ", "by", " ", "their", " ", 
     "\"\<method_name\>\""}], ",", " ", 
    RowBox[{
    "and", " ", "gather", " ", "the", " ", "pka", " ", "and", " ", "logP", 
     " ", "\"\<method_name\>\"", " ", "entries", " ", "in", " ", "seperate", 
     " ", 
     RowBox[{"lists", "."}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.8269297969527893`*^9, {3.826929858514142*^9, 3.82692993363743*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"1f1448ea-1f7b-49fb-9dd0-f0ed771a638c"],

Cell[BoxData["logPmods"], "Input",
 CellChangeTimes->{3.826929981860368*^9},
 CellLabel->
  "In[338]:=",ExpressionUUID->"12f8e219-168f-46d6-a588-2743451d1ab3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"assoc", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "6"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logDmods", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"logPmods", "[", 
       RowBox[{"[", 
        RowBox[{"assoc", "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "<>", 
      "\"\</\>\"", "<>", 
      RowBox[{"pkamods", "[", 
       RowBox[{"[", 
        RowBox[{"assoc", "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"logDmods", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Manual", " ", "combination", " ", "of", " ", "logP", " ", "and", " ", 
     "pKa", " ", "submission", " ", "from", " ", "the", " ", "same", " ", 
     "\"\<Participant organization\>\""}], ",", " ", 
    RowBox[{
     RowBox[{"e", ".", "g", ".", " ", "logP"}], " ", "entry", " ", "2", " ", 
     "is", " ", "associated", " ", "with", " ", "pKa", " ", "entry", " ", 
     "4"}], ",", " ", 
    RowBox[{"8", " ", "with", " ", "5", " ", "and", " ", "so", " ", 
     RowBox[{"on", ".", " ", "List"}], " ", "the", " ", 
     RowBox[{"logP", "/", "pKa"}], " ", "model", " ", "combinations", " ", 
     "here", " ", "as", " ", "a", " ", "sanity", " ", 
     RowBox[{"check", "."}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.8269298290777283`*^9, {3.8269299664422903`*^9, 3.826930004416153*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"36ec0f60-2eec-4b05-834c-d58a6c424efd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"logP", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "1"}], "]"}], "]"}], ",", "jj", ",", 
               "All"}], "]"}], "]"}], ",", 
            RowBox[{"pka", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "1", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "8"}], 
                "}"}]}], "]"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"logP", "[", 
            RowBox[{"[", 
             RowBox[{"assoc", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}], 
         "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "9", ",", "3", ",", "10", ",", "4", ",", "11", ",",
         "5", ",", "6", ",", "7", ",", "12", ",", "8", ",", "13"}], "}"}]}], 
     "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"logD", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "All"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "==", "\"\<SM28\>\""}], "||", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "==", "\"\<SM33\>\""}]}], "&"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "logD"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"logD", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "All"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "!=", "\"\<SM28\>\""}], "&&", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "!=", "\"\<SM33\>\""}]}], "&"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "logD"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Initiate", " ", "the", " ", "logD", " ", "list", " ", "to", " ", "be", 
     " ", "exported", " ", "later", " ", "so", " ", "that", " ", "it", " ", 
     "already", " ", "contains", " ", "the", " ", "pka", " ", "and", " ", 
     "logP", " ", "data"}], ",", " ", "errors", ",", " ", 
    RowBox[{
     RowBox[{"method", " ", "names", " ", 
      RowBox[{"etc", ".", "\[IndentingNewLine]", "Skip"}], " ", "SM28", " ", 
      "and", " ", "SM33", " ", "because", " ", "for", " ", "these", " ", 
      "molecules", " ", "pKa"}], " ", ">", " ", 
     RowBox[{
     "12", " ", "and", " ", "no", " ", "predicted", " ", "pKa", " ", "is", 
      " ", 
      RowBox[{"given", ".", " ", "Use"}], " ", "the", " ", "list", " ", 
      "\"\<tmp\>\"", " ", "to", " ", "remerge", " ", "SM28", " ", "and", " ", 
      "SM33", " ", "entries", " ", "after", " ", "calculating", " ", "logD", 
      " ", "for", " ", "all", " ", "other", " ", 
      RowBox[{"compounds", "."}]}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{3.8269300283551903`*^9},
 CellLabel->
  "In[342]:=",ExpressionUUID->"1225d561-d4ed-4bda-ac1c-24e5da6752e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"True", ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Only", " ", "this", " ", "branch", " ", "is", " ", 
           RowBox[{"evaluated", ".", " ", "Calculates"}], " ", "the", " ", 
           "log", " ", "D7", ".4", " ", "according", " ", "to", " ", 
           RowBox[{"e", ".", "g", ".", " ", "Scherrer"}], " ", "RA"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Howard", " ", "SM", " ", 
            RowBox[{"(", "1977", ")"}], " ", "J", " ", "Med", " ", "Chem", 
            " ", "20"}], ":", 
           RowBox[{"53", "-", "58"}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "and", " ", "the", " ", "combined", " ", "SEM", " ", "and", " ", 
            "model", " ", 
            RowBox[{"uncertainties", ".", "\[IndentingNewLine]", "logD"}]}], 
           "=", 
           RowBox[{"logP", "+", 
            RowBox[{"Log10", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", "pKa"}], ")"}]}]}], ")"}]}]}]}]}]}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"logD", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "+", 
             RowBox[{"Log10", "[", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", 
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}], "]"}]}], ",", 
            "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"7.4", "-", 
                   RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", 
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}], "^", 
             "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "11"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"7.4", "-", 
                   RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", 
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}], "^", 
             "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "13"}], "]"}], "]"}]}]}]}], ";"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "This", " ", "branch", " ", "is", " ", "never", " ", "evaluated"}], 
          ",", " ", 
          RowBox[{
          "but", " ", "would", " ", "do", " ", "the", " ", "same", " ", "as", 
           " ", "the", " ", "other", " ", "branch", " ", "only", " ", "for", 
           " ", 
           RowBox[{"\"\<bases\>\"", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"logD", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "+", 
             RowBox[{"Log10", "[", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}]}], ")"}]}], 
              "]"}]}], ",", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}], ")"}]}], "/", 
               
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}]}], ")"}]}], 
              ")"}], "^", "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "11"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}], ")"}]}], "/", 
               
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}]}], ")"}]}], 
              ")"}], "^", "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "13"}], "]"}], "]"}]}]}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", 
        RowBox[{"Length", "@", 
         RowBox[{"logD", "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", 
      RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"logD", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], ",", 
        RowBox[{"tmp", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "logD"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "tmp", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Technically", " ", "a", " ", "list", " ", "of", " ", "the", " ", 
     "ionization", " ", "states", " ", "for", " ", "the", " ", "most", " ", 
     "relevant", " ", "pKa", " ", "transitions", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"i", ".", "e", ".", " ", "0"}], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], " ", "or", " ", "1"}], "\[Rule]", 
        RowBox[{"0", " ", 
         RowBox[{"etc", "."}]}]}]}], ")"}], " ", "for", " ", "each", " ", 
     "compound", " ", "and", " ", "each", " ", "submission", " ", "is", " ", 
     "needed", " ", "to", " ", "differentiate", " ", "\"\<acids\>\"", " ", 
     "and", " ", "\"\<bases\>\""}], ",", " ", 
    RowBox[{
    "especially", " ", "if", " ", "there", " ", "is", " ", "disagreement", 
     " ", "between", " ", "different", " ", 
     RowBox[{"methods", ".", " ", "Submissions"}], " ", "that", " ", 
     "included", " ", "macrostate", " ", "pKa", " ", "values", " ", "agreed", 
     " ", "that", " ", "every", " ", "relevant", " ", "transition", " ", "is",
      " ", "\"\<0\[Rule]-1\>\"", " ", "so", " ", "only", " ", "this", " ", 
     "equation", " ", "is", " ", "used", " ", "here", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"If", "[", 
        RowBox[{"True", ",", "..."}], "]"}], ")"}], ".", 
      "\[IndentingNewLine]", "After"}], " ", "calculation", " ", "of", " ", 
     "the", " ", "logD", " ", "values", " ", "the", " ", "\"\<tmp\>\"", " ", 
     "list", " ", "containing", " ", "the", " ", "logP", " ", "data", " ", 
     "for", " ", "SM28", " ", "and", " ", "SM33", " ", "is", " ", "merged", 
     " ", "with", " ", "the", " ", "logD", " ", "list", " ", 
     RowBox[{"again", "."}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{3.826930049749216*^9},
 CellLabel->
  "In[345]:=",ExpressionUUID->"699b63f0-f4a6-4e42-874f-e8086b422b95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "logD", "]"}], ",", "13"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logD", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{"ii", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "0", ",", 
       RowBox[{
        RowBox[{"Length", "@", "logD"}], "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"logD", ",", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"exp", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}], "]"}], ",", 
       "3"}], "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logD", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "16"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"logD", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "9"}], "]"}], "]"}], "-", 
    RowBox[{"logD", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "14"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"logD", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "8", ",", "9", ",", "10", ",", "14", ",", "15", ",", "16", ",", 
        "12"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Prepare", " ", "logD", " ", "Table", " ", "for", " ", 
     RowBox[{"export", ".", " ", "Experimental"}], " ", "data", " ", "is", 
     " ", "added", " ", "to", " ", "the", " ", "list"}], ",", " ", 
    RowBox[{
    "the", " ", "difference", " ", "between", " ", "predicted", " ", "and", 
     " ", "experimental", " ", "values", " ", "calculated"}], ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "list", " ", "sorted", " ", "to", " ", "have", 
     " ", "the", " ", "same", " ", "shape", " ", "as", " ", "the", " ", 
     "other", " ", "\"\<submission_collection.csv\>\"", " ", "files"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{3.8269300644437943`*^9},
 CellLabel->
  "In[348]:=",ExpressionUUID->"3af13b5b-adb4-4d97-a1a4-aaf6f5722c40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<./logD_exp_logP_and_all_ranked.csv\>\"", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{"logD", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\>\"", ",", "\"\<logP method_name\>\"", ",", 
        "\"\<pKa method_name\>\"", ",", "\"\<logP file name\>\"", ",", 
        "\"\<pKa file name\>\"", ",", "\"\<logP category\>\"", ",", 
        "\"\<pKa category\>\"", ",", "\"\<Molecule ID\>\"", ",", 
        "\"\<logD7.4 (calc)\>\"", ",", "\"\<logD SEM (calc)\>\"", ",", 
        "\"\<logD7.4 (exp)\>\"", ",", "\"\<logD7.4 SEM (exp)\>\"", ",", 
        "\"\<\[CapitalDelta]logD7.4 error (calc-exp)\>\"", ",", 
        "\"\<logD model uncertainty\>\""}], "}"}]}], "]"}], ",", 
    RowBox[{"\"\<TextDelimiters\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.826930080242112*^9, 3.826930089844138*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"18265f42-a7f8-465b-aeb8-81ca2ed8e36f"],

Cell[BoxData[""], "Input",ExpressionUUID->"8cbe8342-e134-4e40-a186-d1641776e002"],

Cell[TextData[StyleBox["Repeat, but this time combine the best pKa method \
(EC_RISM)+ best log P method (TFE MLR)",
 FontSize->36,
 Background->RGBColor[0.87, 0.94, 1]]], "Text",
 CellChangeTimes->{{3.8269301792476*^9, 3.8269302645365353`*^9}, {
  3.8269303226785107`*^9, 
  3.826930325878237*^9}},ExpressionUUID->"2e9913c3-b57a-4d79-a001-\
6d1b80c2245d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.826930173670493*^9},ExpressionUUID->"bd87e015-ebc9-4825-abca-\
929462561f38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pka", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", 
     "\"\<../../pKa/analysis/macrostate_analysis/analysis_outputs_ranked_\
submissions/pKa_submission_collection.csv\>\"", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "11"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logP", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", 
     "\"\<../../logP/analysis/analysis_outputs_ranked_submissions/logP_\
submission_collection.csv\>\"", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "11"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pka", "=", 
   RowBox[{"GatherBy", "[", 
    RowBox[{"pka", ",", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logP", "=", 
   RowBox[{"GatherBy", "[", 
    RowBox[{"logP", ",", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pka", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"logP", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "=", "\"\<#\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pkamods", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Flatten", "@", 
     RowBox[{"pka", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logPmods", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Flatten", "@", 
     RowBox[{"logP", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.8269303496872997`*^9, {3.8269306141232*^9, 3.826930641389192*^9}, 
   3.826930774504507*^9},
 CellLabel->
  "In[411]:=",ExpressionUUID->"f520b937-a4ad-4e95-bcdd-3cf8940f10d8"],

Cell[BoxData["logPmods"], "Input",
 CellChangeTimes->{{3.826930383782683*^9, 3.8269304129501677`*^9}, 
   3.8269304950810623`*^9, 3.826930569798012*^9, 3.826930702634601*^9, {
   3.826930744221424*^9, 3.8269307489997787`*^9}, 3.826930819371628*^9, 
   3.826930861992489*^9},
 CellLabel->
  "In[424]:=",ExpressionUUID->"bc35d8b7-1fb3-4d17-92d7-152d4199118e"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\"\<file name\>\""},
     {"\"\<pKa_RodriguezPaluch_SMD_1\>\""},
     {"\"\<pKa-RobertRaddi\>\""},
     {"\"\<pKa_prediction_Iorga_Beckstein_1\>\""},
     {"\"\<pKa-IEFPCMMST-1\>\""},
     {"\"\<pKa-VA-2-charge-correction\>\""},
     {"\"\<pKa-ECRISM-1\>\""},
     {"\"\<pka-nhlbi-1c\>\""}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Input",
 CellChangeTimes->{
  3.826930616339159*^9},ExpressionUUID->"d3b17180-80aa-441f-81fe-\
e449de576492"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "\"\<file name\>\"", ",", "\"\<pKa_RodriguezPaluch_SMD_1\>\"", ",", 
   "\"\<pKa-RobertRaddi\>\"", ",", "\"\<pKa_prediction_Iorga_Beckstein_1\>\"",
    ",", "\"\<pKa-IEFPCMMST-1\>\"", ",", "\"\<pKa-VA-2-charge-correction\>\"",
    ",", "\"\<pKa-ECRISM-1\>\"", ",", "\"\<pka-nhlbi-1c\>\""}], "}"}]], \
"Input",
 CellChangeTimes->{3.826930667719997*^9},
 CellLabel->
  "In[401]:=",ExpressionUUID->"88753f31-4a3c-4b17-a7b2-777b8f5d4975"],

Cell[BoxData[
 RowBox[{"pkamods", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.826930394157631*^9, 3.826930414157803*^9}, {
  3.826930811224065*^9, 3.8269308115884323`*^9}},
 CellLabel->
  "In[419]:=",ExpressionUUID->"ea5e54d0-cef1-4d86-8dd7-aa13f0a050ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"assoc", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"4", ",", "7"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logDmods", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"logPmods", "[", 
       RowBox[{"[", 
        RowBox[{"assoc", "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "<>", 
      "\"\</\>\"", "<>", 
      RowBox[{"pkamods", "[", 
       RowBox[{"[", 
        RowBox[{"assoc", "[", 
         RowBox[{"[", 
          RowBox[{"ii", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logDmods", "//", "TableForm"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Manual", " ", "combination", " ", "of", " ", "logP", " ", "and", " ", 
     "pKa", " ", "submission", " ", "from", " ", "the", " ", "same", " ", 
     "\"\<Participant organization\>\""}], ",", " ", 
    RowBox[{
     RowBox[{"e", ".", "g", ".", " ", "logP"}], " ", "entry", " ", "2", " ", 
     "is", " ", "associated", " ", "with", " ", "pKa", " ", "entry", " ", 
     "4"}], ",", " ", 
    RowBox[{"8", " ", "with", " ", "5", " ", "and", " ", "so", " ", 
     RowBox[{"on", ".", " ", "List"}], " ", "the", " ", 
     RowBox[{"logP", "/", "pKa"}], " ", "model", " ", "combinations", " ", 
     "here", " ", "as", " ", "a", " ", "sanity", " ", 
     RowBox[{"check", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ogD", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"logP", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "1"}], "]"}], "]"}], ",", "jj", ",", 
               "All"}], "]"}], "]"}], ",", 
            RowBox[{"pka", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "1", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "8"}], 
                "}"}]}], "]"}], "]"}]}], "}"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"jj", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"logP", "[", 
            RowBox[{"[", 
             RowBox[{"assoc", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}], 
         "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "9", ",", "3", ",", "10", ",", "4", ",", "11", ",",
         "5", ",", "6", ",", "7", ",", "12", ",", "8", ",", "13"}], "}"}]}], 
     "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"logD", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "All"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "==", "\"\<SM28\>\""}], "||", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "==", "\"\<SM33\>\""}]}], "&"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "logD"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"logD", "[", 
        RowBox[{"[", 
         RowBox[{"ii", ",", "All"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "!=", "\"\<SM28\>\""}], "&&", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "!=", "\"\<SM33\>\""}]}], "&"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "logD"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"True", ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Only", " ", "this", " ", "branch", " ", "is", " ", 
           RowBox[{"evaluated", ".", " ", "Calculates"}], " ", "the", " ", 
           "log", " ", "D7", ".4", " ", "according", " ", "to", " ", 
           RowBox[{"e", ".", "g", ".", " ", "Scherrer"}], " ", "RA"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"Howard", " ", "SM", " ", 
            RowBox[{"(", "1977", ")"}], " ", "J", " ", "Med", " ", "Chem", 
            " ", "20"}], ":", 
           RowBox[{"53", "-", "58"}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "and", " ", "the", " ", "combined", " ", "SEM", " ", "and", " ", 
            "model", " ", 
            RowBox[{"uncertainties", ".", "\[IndentingNewLine]", "logD"}]}], 
           "=", 
           RowBox[{"logP", "+", 
            RowBox[{"Log10", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", "pKa"}], ")"}]}]}], ")"}]}]}]}]}]}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"logD", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "+", 
             RowBox[{"Log10", "[", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", 
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}], "]"}]}], ",", 
            "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"7.4", "-", 
                   RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", 
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}], "^", 
             "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "11"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"7.4", "-", 
                   RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"7.4", "-", 
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}], ")"}], "^", 
             "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "13"}], "]"}], "]"}]}]}]}], ";"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "This", " ", "branch", " ", "is", " ", "never", " ", "evaluated"}], 
          ",", " ", 
          RowBox[{
          "but", " ", "would", " ", "do", " ", "the", " ", "same", " ", "as", 
           " ", "the", " ", "other", " ", "branch", " ", "only", " ", "for", 
           " ", 
           RowBox[{"\"\<bases\>\"", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"logD", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "jj", ",", "9"}], "]"}], "]"}], "+", 
             RowBox[{"Log10", "[", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}]}], ")"}]}], 
              "]"}]}], ",", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "10"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}], ")"}]}], "/", 
               
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}]}], ")"}]}], 
              ")"}], "^", "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "11"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"logD", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"logD", "[", 
            RowBox[{"[", 
             RowBox[{"ii", ",", "jj", ",", "12"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}], ")"}]}], "/", 
               
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pka", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"assoc", "[", 
                    RowBox[{"[", 
                    RowBox[{"ii", ",", "2"}], "]"}], "]"}], ",", "jj", ",", 
                    "6"}], "]"}], "]"}], "-", "7.4"}], ")"}]}]}], ")"}]}], 
              ")"}], "^", "2"}], "*", 
            RowBox[{"logD", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "jj", ",", "13"}], "]"}], "]"}]}]}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", 
        RowBox[{"Length", "@", 
         RowBox[{"logD", "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", 
      RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"logD", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], ",", 
        RowBox[{"tmp", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "logD"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "tmp", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "logD", "]"}], ",", "13"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logD", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{"ii", ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", "0", ",", 
       RowBox[{
        RowBox[{"Length", "@", "logD"}], "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"logD", ",", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"exp", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "@", "assoc"}]}], "}"}]}], "]"}], "]"}], ",", 
       "3"}], "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logD", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "16"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"logD", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "9"}], "]"}], "]"}], "-", 
    RowBox[{"logD", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "14"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"logD", "=", 
   RowBox[{"logD", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
        "8", ",", "9", ",", "10", ",", "14", ",", "15", ",", "16", ",", 
        "12"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<./logD_exp_logP_and_all_ranked.csv\>\"", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{"logD", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\>\"", ",", "\"\<logP method_name\>\"", ",", 
        "\"\<pKa method_name\>\"", ",", "\"\<logP file name\>\"", ",", 
        "\"\<pKa file name\>\"", ",", "\"\<logP category\>\"", ",", 
        "\"\<pKa category\>\"", ",", "\"\<Molecule ID\>\"", ",", 
        "\"\<logD7.4 (calc)\>\"", ",", "\"\<logD SEM (calc)\>\"", ",", 
        "\"\<logD7.4 (exp)\>\"", ",", "\"\<logD7.4 SEM (exp)\>\"", ",", 
        "\"\<\[CapitalDelta]logD7.4 error (calc-exp)\>\"", ",", 
        "\"\<logD model uncertainty\>\""}], "}"}]}], "]"}], ",", 
    RowBox[{"\"\<TextDelimiters\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.826930362368541*^9, {3.82693087895774*^9, 3.826930907486905*^9}, {
   3.826980256555278*^9, 
   3.8269802881419153`*^9}},ExpressionUUID->"2011a0b8-be94-408d-8d4b-\
2d8fdf6123f3"]
},
WindowSize->{1680, 997},
WindowMargins->{{0, Automatic}, {Automatic, 1}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
Magnification:>1.5 Inherited,
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0ba00511-db7c-44ab-b44d-b3cc093d815c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1165, 29, 139, "Input",ExpressionUUID->"e07bf09a-837b-4f9f-8ae3-5348be5ddf17"],
Cell[1726, 51, 143, 2, 44, "Input",ExpressionUUID->"aabee575-ae6b-41e4-b5f0-da1db60272a3"],
Cell[1872, 55, 151, 3, 44, "Input",ExpressionUUID->"78eb6dc2-16ad-4001-9098-f6012ebe6827"],
Cell[2026, 60, 4406, 107, 295, "Input",ExpressionUUID->"8416a644-c7b6-49ed-b9a7-00441e0da565"],
Cell[6435, 169, 174, 3, 44, "Input",ExpressionUUID->"7e9772ff-a5eb-4fea-abe4-9be5751b52ec"],
Cell[6612, 174, 152, 3, 44, "Input",ExpressionUUID->"980770e8-8c7c-4c9b-9c96-921e9bac7453"],
Cell[6767, 179, 2971, 69, 170, "Input",ExpressionUUID->"8379e00e-31fd-45ee-947a-f7bdd9f9030f"],
Cell[9741, 250, 7216, 156, 232, "Input",ExpressionUUID->"9f3db9fc-4bd0-4901-a278-800e3ef14180"],
Cell[16960, 408, 16379, 374, 638, "Input",ExpressionUUID->"8dcda01e-2c9e-4dc5-8077-5ebe246709ad"],
Cell[33342, 784, 149, 3, 44, "Input",ExpressionUUID->"8c5188f9-101e-4c8a-96a9-05815eea9909"],
Cell[33494, 789, 6071, 122, 232, "Input",ExpressionUUID->"b8094c35-5837-436f-8f85-46a68c4f4313"],
Cell[39568, 913, 1814, 31, 108, "Input",ExpressionUUID->"a980ffde-5f1c-41eb-859a-645f6f681bab"],
Cell[41385, 946, 81, 0, 44, "Input",ExpressionUUID->"3bff58ae-3b3c-448e-abda-55839fc41921"],
Cell[41469, 948, 304, 6, 166, "Text",ExpressionUUID->"df58675c-2edd-40a5-b990-47cdab947cbc"],
Cell[41776, 956, 2687, 82, 295, "Input",ExpressionUUID->"b74e55a7-d1b9-41c4-9a63-38a9439472dd"],
Cell[44466, 1040, 2060, 57, 170, "Input",ExpressionUUID->"46025181-a9bc-49f3-8c42-8aac84ff2e6c"],
Cell[46529, 1099, 4119, 114, 232, "Input",ExpressionUUID->"a76dfec1-ca21-4cd9-a015-8f76f7008849"],
Cell[50651, 1215, 12923, 327, 546, "Input",ExpressionUUID->"63b0d55f-6fbb-4f3b-a9af-9ce1536327eb"],
Cell[63577, 1544, 2667, 76, 249, "Input",ExpressionUUID->"5d8e94f4-5668-40d1-9dc1-68714914e083"],
Cell[66247, 1622, 988, 20, 57, "Input",ExpressionUUID->"61e9f7d8-e1c9-4123-b3ee-977760a163c9"],
Cell[67238, 1644, 305, 6, 93, "Text",ExpressionUUID->"7c9679ce-82d8-4b8f-9256-ea3dfae70fd8"],
Cell[67546, 1652, 2693, 82, 282, "Input",ExpressionUUID->"1f1448ea-1f7b-49fb-9dd0-f0ed771a638c"],
Cell[70242, 1736, 159, 3, 57, "Input",ExpressionUUID->"12f8e219-168f-46d6-a588-2743451d1ab3"],
Cell[70404, 1741, 2107, 57, 183, "Input",ExpressionUUID->"36ec0f60-2eec-4b05-834c-d58a6c424efd"],
Cell[72514, 1800, 4119, 114, 183, "Input",ExpressionUUID->"1225d561-d4ed-4bda-ac1c-24e5da6752e8"],
Cell[76636, 1916, 12921, 327, 915, "Input",ExpressionUUID->"699b63f0-f4a6-4e42-874f-e8086b422b95"],
Cell[89560, 2245, 2669, 76, 264, "Input",ExpressionUUID->"3af13b5b-adb4-4d97-a1a4-aaf6f5722c40"],
Cell[92232, 2323, 986, 20, 140, "Input",ExpressionUUID->"18265f42-a7f8-465b-aeb8-81ca2ed8e36f"],
Cell[93221, 2345, 81, 0, 46, "Input",ExpressionUUID->"8cbe8342-e134-4e40-a186-d1641776e002"],
Cell[93305, 2347, 356, 7, 166, "Text",ExpressionUUID->"2e9913c3-b57a-4d79-a001-6d1b80c2245d"],
Cell[93664, 2356, 128, 3, 46, "Input",ExpressionUUID->"bd87e015-ebc9-4825-abca-929462561f38"],
Cell[93795, 2361, 2309, 73, 295, "Input",ExpressionUUID->"f520b937-a4ad-4e95-bcdd-3cf8940f10d8"],
Cell[96107, 2436, 357, 6, 46, "Input",ExpressionUUID->"bc35d8b7-1fb3-4d17-92d7-152d4199118e"],
Cell[96467, 2444, 830, 25, 258, "Input",ExpressionUUID->"d3b17180-80aa-441f-81fe-e449de576492"],
Cell[97300, 2471, 476, 10, 57, "Input",ExpressionUUID->"88753f31-4a3c-4b17-a7b2-777b8f5d4975"],
Cell[97779, 2483, 264, 5, 57, "Input",ExpressionUUID->"ea5e54d0-cef1-4d86-8dd7-aa13f0a050ed"],
Cell[98046, 2490, 18463, 501, 1411, "Input",ExpressionUUID->"2011a0b8-be94-408d-8d4b-2d8fdf6123f3"]
}
]
*)

